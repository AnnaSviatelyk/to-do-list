!function(e){var t={};function n(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);const s={inputSummary:".task__description",newItem:".new-item",createNewItem:".add-new-item",input:".add-new-item__description",enableEdit:".task__name",submitBtn:".add-new-item__btn-add-task",cancelBtn:".add-new-item__btn-cancel",tasksContainer:".tasks-container",deleteBtn:".task__btn-delete",editBtn:".task__btn-edit",doneBtn:".task__btn-done",BtnsContainer:".task__btns",editBtnsContainer:".task__btns--edit",exitEditBtn:".task__btn-exit-edit",taskCheckbox:".task__checkbox_svg",taskCheckboxContainer:".task__checkbox",inputForTaskUpdate:".task__edit-input-text",taskNameWrapper:".task__name-wrapper",time:".header__data--time",date:".header__data--date"};function a(e){return e<10?`0${e}`:e}var i=class{constructor(e){this.summary=e,this.id=function(e=5){let t="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=n.length;for(let a=0;a<e;a++)t+=n.charAt(Math.floor(Math.random()*s));return t}(5)}};const r='<i class="task__btn-done"></i>\n<i class="task__btn-exit-edit"></i>',d='<i class="task__btn-edit"></i>\n<i class="task__btn-delete"></i>',c=37,o=100;var l=class{constructor(){this.updateSummary=this.updateSummary.bind(this),this.keyPressHandler=this.keyPressHandler.bind(this),this.editBtnClickHandler=this.editBtnClickHandler.bind(this),this.documentClickHandler=this.documentClickHandler.bind(this),this.clickOnExitBtnHandler=this.clickOnExitBtnHandler.bind(this),this.checkboxDisplayHandler=this.checkboxDisplayHandler.bind(this)}addTaskToUI(e){const t=document.querySelector(s.tasksContainer),n=this.getTaskHtmlString(e);t.insertAdjacentHTML("beforeend",n);const a=document.getElementById(e.id);this.addTaskEventListeners(a)}removeTaskFromUI(e){const t=document.getElementById(e);t.parentNode.removeChild(t)}addTaskEventListeners(e){e.querySelector(s.editBtn).addEventListener("click",this.editBtnClickHandler),e.querySelector(s.deleteBtn).addEventListener("click",m.deleteTask),e.querySelector(s.taskCheckbox).addEventListener("animationend",e=>{m.deleteTask(e,!0)})}editBtnClickHandler(e){e.stopPropagation();const t=e.target.closest(".task"),n=t.querySelector(".task__name").textContent,a=e.target.closest(s.BtnsContainer);this.checkboxDisplayHandler(t),a.innerHTML=r;const i=document.getElementById(t.id).querySelector(s.taskNameWrapper),d=i.firstElementChild.offsetHeight;document.querySelector(s.doneBtn).addEventListener("click",this.updateSummary),document.querySelector(s.exitEditBtn).addEventListener("click",e=>{this.clickOnExitBtnHandler(e,n,i,a)});const c=`<textarea class="task__edit-input-text " type="text" autofocus>${n}</textarea>`;i.innerHTML=c;const l=i.firstChild;l.select(),l.addEventListener("input",this.inputHandler),document.addEventListener("click",this.documentClickHandler),l.addEventListener("keypress",this.keyPressHandler);let u=Math.min(o,d);const k=parseFloat(window.getComputedStyle(l,null).getPropertyValue("padding-top"));l.style.height=u+2*k+"px"}checkboxDisplayHandler(e){const t=e.querySelector(s.taskCheckboxContainer);t.classList.contains("task__checkbox--hidden")?t.classList.remove("task__checkbox--hidden"):t.classList.add("task__checkbox--hidden")}clickOnExitBtnHandler(e,t,n,s){const a=` <span class="task__name">${t}</span>`,i=e.target.closest(".task");n.innerHTML=a,s.innerHTML=d,this.checkboxDisplayHandler(i),this.addTaskEventListeners(i),document.removeEventListener("click",this.documentClickHandler)}documentClickHandler(e){const t=e.target.classList[0];["task__edit-input-text","task__btn-done","task__btn-exit-edit"].includes(t)||this.updateSummary()}inputHandler(e){const t=e.target.value;if(e.target.rows=1,e.target.style.height="auto",""===t)e.target.style.height=c+"px",e.target.classList.add("task__edit-input-text--invalid");else{const t=e.target.scrollHeight;let n=Math.min(o,t);e.target.style.height=n+"px",e.target.classList.remove("task__edit-input-text--invalid")}}keyPressHandler(e){13===e.keyCode&&(e.preventDefault(),""!==e.target.value&&this.updateSummary(e))}updateSummary(){const e=document.querySelector(s.inputForTaskUpdate),t=e.value,n=e.closest(".task"),a=n.id,i=n.querySelector(s.BtnsContainer),r=n.querySelector(s.taskNameWrapper);if(this.checkboxDisplayHandler(n),""!==t){document.removeEventListener("click",this.documentClickHandler);const e=` <span class="task__name">${t}</span>`;i.innerHTML=d,r.innerHTML=e,this.addTaskEventListeners(n),m.updateTask(a,t)}}getTaskHtmlString(e){return`<div class="task" id="${e.id}">\n        <div class="task__content-wrapper">\n        <div class="task__description">\n        <label class='task__checkbox'>\n        <input type="checkbox" name="check">\n        <svg version="1.1" class="task__checkbox_svg" xmlns="http://www.w3.org/2000/svg"\n            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100"\n            style="enable-background:new 0 0 100 100;" xml:space="preserve">\n            <polyline class="task__checkbox_line" points="3.5,45.5 40.5,82.5 95.7,15.3 "\n                stroke-linecap="round" /></svg>\n    </label>\n    \n    <div class="task__name-wrapper">\n    <span class="task__name" title="${e.summary}">${e.summary}</span>\n    </div>\n    </div>\n    <div class="task__btns">\n    <i class="task__btn-edit"></i>\n    <i class="task__btn-delete"></i>\n    </div>\n    </div>\n    <div class="line"></div></div>`}};const u=new class{constructor(){this.tasks=[]}createTask(e){const t=new i(e);return this.tasks.push(t),this.saveChangesToLocalStorage(),t}readTasks(){return this.tasks=JSON.parse(localStorage.getItem("tasks"))||[],this.tasks}deleteTask(e){const t=this.tasks.findIndex(t=>t.id===e);-1!==t&&this.tasks.splice(t,1),this.saveChangesToLocalStorage()}updateTask(e,t){this.tasks.find(t=>t.id===e).summary=t,this.saveChangesToLocalStorage()}saveChangesToLocalStorage(){localStorage.setItem("tasks",JSON.stringify(this.tasks))}},k=new l;var m=new class{createTask(e){const t=u.createTask(e);k.addTaskToUI({...t})}renderTasks(){u.readTasks().forEach(e=>k.addTaskToUI(e))}deleteTask(e){const t=e.target.closest(".task").id;u.deleteTask(t),k.removeTaskFromUI(t),u.saveChangesToLocalStorage()}updateTask(e,t){u.updateTask(e,t)}};(()=>{const e=document.querySelector(s.newItem),t=document.querySelector(s.createNewItem),n=document.querySelector(s.submitBtn);m.renderTasks(),document.querySelector(s.newItem).addEventListener("click",()=>{e.style.display="none",t.style.display="inline-block",document.querySelector(s.input).value=""});const i=n=>{n.length&&(m.createTask(n),e.style.display="inline-flex",t.style.display="none")};document.querySelector(s.submitBtn).addEventListener("click",()=>{const e=document.querySelector(s.input).value;n.classList.add("add-new-item__btn-add-task--disabled"),i(e)}),document.querySelector(s.input).addEventListener("keypress",e=>{if(13===e.keyCode){const t=e.target.value;i(t)}}),document.querySelector(s.input).addEventListener("input",()=>{n.classList.remove("add-new-item__btn-add-task--disabled")}),document.querySelector(s.cancelBtn).addEventListener("click",()=>{e.style.display="inline-flex",t.style.display="none"});const{day:r,month:d,year:c,hours:o,minutes:l}=function(){const e=new Date,t=e.getDate(),n=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],s=e.getFullYear();let i=e.getHours();i=a(i);let r=e.getMinutes();return{day:t,month:n,year:s,hours:i,minutes:r=a(r)}}();document.querySelector(s.date).textContent=`${r} ${d}, ${c}`,document.querySelector(s.time).textContent=`${o}:${l}`})()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2RvbVN0cmluZ3MuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL1Rhc2suanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL1Rhc2tWaWV3LmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9UYXNrc0NvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL1Rhc2tNb2RlbC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkRPTXN0cmluZ3MiLCJpbnB1dFN1bW1hcnkiLCJuZXdJdGVtIiwiY3JlYXRlTmV3SXRlbSIsImlucHV0IiwiZW5hYmxlRWRpdCIsInN1Ym1pdEJ0biIsImNhbmNlbEJ0biIsInRhc2tzQ29udGFpbmVyIiwiZGVsZXRlQnRuIiwiZWRpdEJ0biIsImRvbmVCdG4iLCJCdG5zQ29udGFpbmVyIiwiZWRpdEJ0bnNDb250YWluZXIiLCJleGl0RWRpdEJ0biIsInRhc2tDaGVja2JveCIsInRhc2tDaGVja2JveENvbnRhaW5lciIsImlucHV0Rm9yVGFza1VwZGF0ZSIsInRhc2tOYW1lV3JhcHBlciIsInRpbWUiLCJkYXRlIiwiZm9ybWF0VGltZSIsImpzX1Rhc2siLCJbb2JqZWN0IE9iamVjdF0iLCJzdW1tYXJ5IiwidGhpcyIsImlkIiwibGVuZ3RoIiwicmVzdWx0IiwiY2hhcmFjdGVycyIsImNoYXJhY3RlcnNMZW5ndGgiLCJjaGFyQXQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJtYWtlaWQiLCJkb25lRXhpdEJ0bnMiLCJlZGl0RGVsZXRlQnRucyIsInNwYW5IZWlnaHRXaXRoT25lTGluZSIsIm1heFRleHRBcmVhSGVpZ2h0IiwianNfVGFza1ZpZXciLCJ1cGRhdGVTdW1tYXJ5Iiwia2V5UHJlc3NIYW5kbGVyIiwiZWRpdEJ0bkNsaWNrSGFuZGxlciIsImRvY3VtZW50Q2xpY2tIYW5kbGVyIiwiY2xpY2tPbkV4aXRCdG5IYW5kbGVyIiwiY2hlY2tib3hEaXNwbGF5SGFuZGxlciIsInRhc2siLCJjb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJlbGVtZW50IiwiZ2V0VGFza0h0bWxTdHJpbmciLCJpbnNlcnRBZGphY2VudEhUTUwiLCJjcmVhdGVkRWxlbWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWRkVGFza0V2ZW50TGlzdGVuZXJzIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImpzX1Rhc2tzQ29udHJvbGxlciIsImRlbGV0ZVRhc2siLCJldmVudCIsInN0b3BQcm9wYWdhdGlvbiIsImVkaXRpbmdFbGVtZW50IiwidGFyZ2V0IiwiY2xvc2VzdCIsInRleHRDb250ZW50IiwiYnRuc0NvbnRhaW5lciIsImlubmVySFRNTCIsInRleHRTcGFuSGVpZ2h0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJvZmZzZXRIZWlnaHQiLCJlZGl0SW5wdXQiLCJ0ZXh0QXJlYSIsImZpcnN0Q2hpbGQiLCJzZWxlY3QiLCJpbnB1dEhhbmRsZXIiLCJuZXh0SGVpZ2h0IiwibWluIiwidGV4dEFyZWFQYWRkaW5nVG9wIiwicGFyc2VGbG9hdCIsIndpbmRvdyIsImdldENvbXB1dGVkU3R5bGUiLCJnZXRQcm9wZXJ0eVZhbHVlIiwic3R5bGUiLCJoZWlnaHQiLCJlZGl0aW5nVGFzayIsImNoZWNrYm94IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJhZGQiLCJhZnRlckV4aXRTcGFuIiwidGFza0VsZW1lbnQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY2xhc3NOYW1lIiwiaW5jbHVkZXMiLCJyb3dzIiwic2Nyb2xsSGVpZ2h0Iiwia2V5Q29kZSIsInByZXZlbnREZWZhdWx0IiwiYWZ0ZXJFZGl0U3BhbiIsInVwZGF0ZVRhc2siLCJ0YXNrTW9kZWwiLCJ0YXNrcyIsIm5ld1Rhc2siLCJwdXNoIiwic2F2ZUNoYW5nZXNUb0xvY2FsU3RvcmFnZSIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJpbmRleCIsImZpbmRJbmRleCIsImN1ciIsInNwbGljZSIsImZpbmQiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwidGFza1ZpZXciLCJjcmVhdGVUYXNrIiwiYWRkVGFza1RvVUkiLCJyZWFkVGFza3MiLCJmb3JFYWNoIiwiaXRlbUlEIiwicmVtb3ZlVGFza0Zyb21VSSIsIm5ld0l0ZW1TdHlsZSIsImNyZWF0ZU5ld0l0ZW1TdHlsZSIsInRvZ2dsZVN1Ym1pdEJ0biIsInJlbmRlclRhc2tzIiwiZGlzcGxheSIsImFkZFRhc2siLCJkYXkiLCJtb250aCIsInllYXIiLCJob3VycyIsIm1pbnV0ZXMiLCJub3ciLCJEYXRlIiwiZ2V0RGF0ZSIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJnZXRDdXJyZW50VGltZSIsImluaXQiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxZQUFBLENBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBckIsRUFBQXFCLElBQ0EsRUFBQUUsRUFBQSxPQUFBRixFQUNBLEtBQUFFLEdBQUEsaUJBQUFGLFFBQUFHLFdBQUEsT0FBQUgsRUFDQSxJQUFBSSxFQUFBWCxPQUFBWSxPQUFBLE1BR0EsR0FGQTFCLEVBQUFrQixFQUFBTyxHQUNBWCxPQUFBQyxlQUFBVSxFQUFBLFdBQXlDVCxZQUFBLEVBQUFLLFVBQ3pDLEVBQUFFLEdBQUEsaUJBQUFGLEVBQUEsUUFBQU0sS0FBQU4sRUFBQXJCLEVBQUFVLEVBQUFlLEVBQUFFLEVBQUEsU0FBQUEsR0FBZ0gsT0FBQU4sRUFBQU0sSUFBcUJDLEtBQUEsS0FBQUQsSUFDckksT0FBQUYsR0FJQXpCLEVBQUE2QixFQUFBLFNBQUExQixHQUNBLElBQUFTLEVBQUFULEtBQUFxQixXQUNBLFdBQTJCLE9BQUFyQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFILEVBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBaUIsRUFBQUMsR0FBc0QsT0FBQWpCLE9BQUFrQixVQUFBQyxlQUFBMUIsS0FBQXVCLEVBQUFDLElBR3REL0IsRUFBQWtDLEVBQUEsR0FJQWxDLElBQUFtQyxFQUFBLGdFQ2xGTyxNQUFBQyxFQUFBLENBQ1BDLGFBQUEscUJBQ0FDLFFBQUEsWUFDQUMsY0FBQSxnQkFDQUMsTUFBQSw2QkFDQUMsV0FBQSxjQUNBQyxVQUFBLDhCQUNBQyxVQUFBLDRCQUNBQyxlQUFBLG1CQUNBQyxVQUFBLG9CQUNBQyxRQUFBLGtCQUNBQyxRQUFBLGtCQUNBQyxjQUFBLGNBQ0FDLGtCQUFBLG9CQUNBQyxZQUFBLHVCQUNBQyxhQUFBLHNCQUNBQyxzQkFBQSxrQkFDQUMsbUJBQUEseUJBQ0FDLGdCQUFBLHNCQUNBQyxLQUFBLHNCQUNBQyxLQUFBLHVCQ1NBLFNBQUFDLEVBQUFGLEdBQ0EsT0FBQUEsRUFBQSxPQUEyQkEsSUFBS0EsRUNqQmpCLElBQUFHLEVBUGYsTUFDQUMsWUFBQUMsR0FDQUMsS0FBQUQsVUFDQUMsS0FBQUMsR0RSTyxTQUFBQyxFQUFBLEdBQ1AsSUFBQUMsRUFBQSxHQUNBLE1BQUFDLEVBQUEsaUVBQ0FDLEVBQUFELEVBQUFGLE9BQ0EsUUFBQTNELEVBQUEsRUFBbUJBLEVBQUEyRCxFQUFZM0QsSUFDL0I0RCxHQUFBQyxFQUFBRSxPQUFBQyxLQUFBQyxNQUFBRCxLQUFBRSxTQUFBSixJQUVBLE9BQUFGLEVDQ2tCTyxDQUFNLEtDTnhCLE1BQUFDLEVBQUEsc0VBRUFDLEVBQUEsbUVBRUFDLEVBQUEsR0FDQUMsRUFBQSxJQXdMZSxJQUFBQyxFQXJMZixNQUNBakIsY0FDQUUsS0FBQWdCLGNBQUFoQixLQUFBZ0IsY0FBQWpELEtBQUFpQyxNQUNBQSxLQUFBaUIsZ0JBQUFqQixLQUFBaUIsZ0JBQUFsRCxLQUFBaUMsTUFDQUEsS0FBQWtCLG9CQUFBbEIsS0FBQWtCLG9CQUFBbkQsS0FBQWlDLE1BQ0FBLEtBQUFtQixxQkFBQW5CLEtBQUFtQixxQkFBQXBELEtBQUFpQyxNQUNBQSxLQUFBb0Isc0JBQUFwQixLQUFBb0Isc0JBQUFyRCxLQUFBaUMsTUFDQUEsS0FBQXFCLHVCQUFBckIsS0FBQXFCLHVCQUFBdEQsS0FBQWlDLE1BR0FGLFlBQUF3QixHQUNBLE1BQUFDLEVBQUFDLFNBQUFDLGNBQWlEbEQsRUFBVVEsZ0JBQzNEMkMsRUFBQTFCLEtBQUEyQixrQkFBQUwsR0FDQUMsRUFBQUssbUJBQUEsWUFBQUYsR0FFQSxNQUFBRyxFQUFBTCxTQUFBTSxlQUFBUixFQUFBckIsSUFDQUQsS0FBQStCLHNCQUFBRixHQUlBL0IsaUJBQUFHLEdBQ0EsTUFBQXlCLEVBQUFGLFNBQUFNLGVBQUE3QixHQUNBeUIsRUFBQU0sV0FBQUMsWUFBQVAsR0FHQTVCLHNCQUFBNEIsR0FDQUEsRUFBQUQsY0FBOEJsRCxFQUFVVSxTQUFBaUQsaUJBQUEsUUFBQWxDLEtBQUFrQixxQkFDeENRLEVBQUFELGNBQThCbEQsRUFBVVMsV0FBQWtELGlCQUFBLFFBQXNDQyxFQUFlQyxZQUM3RlYsRUFBQUQsY0FBOEJsRCxFQUFVZSxjQUFBNEMsaUJBQUEsZUFBQUcsSUFDNUJGLEVBQWVDLFdBQUFDLEdBQUEsS0FLM0J2QyxvQkFBQXVDLEdBQ0FBLEVBQUFDLGtCQUVBLE1BQUFDLEVBQUFGLEVBQUFHLE9BQUFDLFFBQUEsU0FDQWpGLEVBQUErRSxFQUFBZCxjQUFBLGVBQUFpQixZQUVBQyxFQUFBTixFQUFBRyxPQUFBQyxRQUFtRGxFLEVBQVVZLGVBRTdEYSxLQUFBcUIsdUJBQUFrQixHQUdBSSxFQUFBQyxVQUFBakMsRUFHQSxNQUFBbEIsRUFBQStCLFNBQUFNLGVBQUFTLEVBQUF0QyxJQUFBd0IsY0FBeUZsRCxFQUFVa0IsaUJBQ25Hb0QsRUFBQXBELEVBQUFxRCxrQkFBQUMsYUFHQXZCLFNBQUFDLGNBQStCbEQsRUFBVVcsU0FBQWdELGlCQUFBLFFBQUFsQyxLQUFBZ0IsZUFDekNRLFNBQUFDLGNBQStCbEQsRUFBVWMsYUFBQTZDLGlCQUFBLFFBQUFHLElBQ3pDckMsS0FBQW9CLHNCQUFBaUIsRUFBQTdFLEVBQUFpQyxFQUFBa0QsS0FHQSxNQUFBSyxvRUFBNEZ4RixlQUM1RmlDLEVBQUFtRCxVQUFBSSxFQUdBLE1BQUFDLEVBQUF4RCxFQUFBeUQsV0FDQUQsRUFBQUUsU0FFQUYsRUFBQWYsaUJBQUEsUUFBQWxDLEtBQUFvRCxjQUNBNUIsU0FBQVUsaUJBQUEsUUFBQWxDLEtBQUFtQixzQkFDQThCLEVBQUFmLGlCQUFBLFdBQUFsQyxLQUFBaUIsaUJBR0EsSUFBQW9DLEVBQUE5QyxLQUFBK0MsSUFBQXhDLEVBQUErQixHQUNBLE1BQUFVLEVBQUFDLFdBQUFDLE9BQUFDLGlCQUFBVCxFQUFBLE1BQUFVLGlCQUFBLGdCQUNBVixFQUFBVyxNQUFBQyxPQUFBUixFQUFBLEVBQUFFLEVBQUEsS0FHQXpELHVCQUFBZ0UsR0FDQSxNQUFBQyxFQUFBRCxFQUFBckMsY0FBbURsRCxFQUFVZ0IsdUJBQzdEd0UsRUFBQUMsVUFBQUMsU0FBQSwwQkFDQUYsRUFBQUMsVUFBQUUsT0FBQSwwQkFFQUgsRUFBQUMsVUFBQUcsSUFBQSwwQkFJQXJFLHNCQUFBdUMsRUFBQTdFLEVBQUFpQyxFQUFBa0QsR0FDQSxNQUFBeUIsK0JBQTJENUcsV0FDM0Q2RyxFQUFBaEMsRUFBQUcsT0FBQUMsUUFBQSxTQUVBaEQsRUFBQW1ELFVBQUF3QixFQUNBekIsRUFBQUMsVUFBQWhDLEVBRUFaLEtBQUFxQix1QkFBQWdELEdBRUFyRSxLQUFBK0Isc0JBQUFzQyxHQUNBN0MsU0FBQThDLG9CQUFBLFFBQUF0RSxLQUFBbUIsc0JBS0FyQixxQkFBQXVDLEdBQ0EsTUFDQWtDLEVBQUFsQyxFQUFBRyxPQUFBd0IsVUFBQSxHQURBLGlFQUdBUSxTQUFBRCxJQUNBdkUsS0FBQWdCLGdCQUlBbEIsYUFBQXVDLEdBQ0EsTUFBQTdFLEVBQUE2RSxFQUFBRyxPQUFBaEYsTUFHQSxHQUZBNkUsRUFBQUcsT0FBQWlDLEtBQUEsRUFDQXBDLEVBQUFHLE9BQUFvQixNQUFBQyxPQUFBLE9BQ0EsS0FBQXJHLEVBQ0E2RSxFQUFBRyxPQUFBb0IsTUFBQUMsT0FBQWhELEVBQUEsS0FDQXdCLEVBQUFHLE9BQUF3QixVQUFBRyxJQUFBLHNDQUVTLENBQ1QsTUFBQU8sRUFBQXJDLEVBQUFHLE9BQUFrQyxhQUNBLElBQUFyQixFQUFBOUMsS0FBQStDLElBQUF4QyxFQUFBNEQsR0FFQXJDLEVBQUFHLE9BQUFvQixNQUFBQyxPQUFBUixFQUFBLEtBQ0FoQixFQUFBRyxPQUFBd0IsVUFBQUUsT0FBQSxtQ0FJQXBFLGdCQUFBdUMsR0FDQSxLQUFBQSxFQUFBc0MsVUFDQXRDLEVBQUF1QyxpQkFDQSxLQUFBdkMsRUFBQUcsT0FBQWhGLE9BQ0F3QyxLQUFBZ0IsY0FBQXFCLElBS0F2QyxnQkFDQSxNQUFBbkIsRUFBQTZDLFNBQUFDLGNBQTZDbEQsRUFBVWlCLG9CQUN2RGhDLEVBQUFtQixFQUFBbkIsTUFDQTZHLEVBQUExRixFQUFBOEQsUUFBQSxTQUNBeEMsRUFBQW9FLEVBQUFwRSxHQUVBMEMsRUFBQTBCLEVBQUE1QyxjQUF3RGxELEVBQVVZLGVBQ2xFTSxFQUFBNEUsRUFBQTVDLGNBQTBEbEQsRUFBVWtCLGlCQUlwRSxHQUZBTyxLQUFBcUIsdUJBQUFnRCxHQUVBLEtBQUE3RyxFQUFBLENBQ0FnRSxTQUFBOEMsb0JBQUEsUUFBQXRFLEtBQUFtQixzQkFDQSxNQUFBMEQsK0JBQStEckgsV0FDL0RtRixFQUFBQyxVQUFBaEMsRUFDQW5CLEVBQUFtRCxVQUFBaUMsRUFDQTdFLEtBQUErQixzQkFBQXNDLEdBQ1lsQyxFQUFlMkMsV0FBQTdFLEVBQUF6QyxJQUkzQnNDLGtCQUFBd0IsR0FDQSwrQkFBeUNBLEVBQUFyQixvcUJBYUhxQixFQUFBdkIsWUFBaUJ1QixFQUFBdkIsK01DOUt2RCxNQUFBZ0YsRUFBQSxJQ0hBLE1BQ0FqRixjQUNBRSxLQUFBZ0YsTUFBQSxHQUlBbEYsV0FBQUMsR0FFQSxNQUFBa0YsRUFBQSxJQUE0QnBGLEVBQUlFLEdBS2hDLE9BRkFDLEtBQUFnRixNQUFBRSxLQUFBRCxHQUNBakYsS0FBQW1GLDRCQUNBRixFQUlBbkYsWUFFQSxPQURBRSxLQUFBZ0YsTUFBQUksS0FBQUMsTUFBQUMsYUFBQUMsUUFBQSxjQUNBdkYsS0FBQWdGLE1BSUFsRixXQUFBRyxHQUVBLE1BQUF1RixFQUFBeEYsS0FBQWdGLE1BQUFTLFVBQUFDLEtBQUF6RixTQUVBLElBQUF1RixHQUNBeEYsS0FBQWdGLE1BQUFXLE9BQUFILEVBQUEsR0FHQXhGLEtBQUFtRiw0QkFJQXJGLFdBQUFHLEVBQUF6QyxHQUNBd0MsS0FBQWdGLE1BQUFZLEtBQUFGLEtBQUF6RixRQUNBRixRQUFBdkMsRUFDQXdDLEtBQUFtRiw0QkFJQXJGLDRCQUNBd0YsYUFBQU8sUUFBQSxRQUFBVCxLQUFBVSxVQUFBOUYsS0FBQWdGLFVEdkNBZSxFQUFBLElBQXFCaEYsRUFvQ04sSUFBQW9CLEVBRmYsSUEvQkEsTUFDQXJDLFdBQUFDLEdBQ0EsTUFBQWtGLEVBQUFGLEVBQUFpQixXQUFBakcsR0FHQWdHLEVBQUFFLFlBQUEsSUFBOEJoQixJQUc5Qm5GLGNBQ0FpRixFQUFBbUIsWUFDQUMsUUFBQVQsR0FBQUssRUFBQUUsWUFBQVAsSUFHQTVGLFdBQUF1QyxHQUNBLE1BQUErRCxFQUFBL0QsRUFBQUcsT0FBQUMsUUFBQSxTQUFBeEMsR0FDQThFLEVBQUEzQyxXQUFBZ0UsR0FHQUwsRUFBQU0saUJBQUFELEdBQ0FyQixFQUFBSSw0QkFLQXJGLFdBQUFHLEVBQUF6QyxHQUNBdUgsRUFBQUQsV0FBQTdFLEVBQUF6QyxLRTVCQSxNQUNBLE1BQUE4SSxFQUFBOUUsU0FBQUMsY0FBZ0RsRCxFQUFVRSxTQUMxRDhILEVBQUEvRSxTQUFBQyxjQUFzRGxELEVBQVVHLGVBQ2hFOEgsRUFBQWhGLFNBQUFDLGNBQW1EbEQsRUFBVU0sV0FJekRzRCxFQUFlc0UsY0FHbkJqRixTQUFBQyxjQUEyQmxELEVBQVVFLFNBQUF5RCxpQkFBQSxhQUNyQ29FLEVBQUExQyxNQUFBOEMsUUFBQSxPQUNBSCxFQUFBM0MsTUFBQThDLFFBQUEsZUFDQWxGLFNBQUFDLGNBQStCbEQsRUFBVUksT0FBQW5CLE1BQUEsS0FJekMsTUFBQW1KLEVBQUE1RyxJQUNBQSxFQUFBRyxTQUNZaUMsRUFBZTZELFdBQUFqRyxHQUMzQnVHLEVBQUExQyxNQUFBOEMsUUFBQSxjQUNBSCxFQUFBM0MsTUFBQThDLFFBQUEsU0FJQWxGLFNBQUFDLGNBQTJCbEQsRUFBVU0sV0FBQXFELGlCQUFBLGFBQ3JDLE1BQUFuQyxFQUFBeUIsU0FBQUMsY0FBK0NsRCxFQUFVSSxPQUFBbkIsTUFDekRnSixFQUFBeEMsVUFBQUcsSUFBQSx3Q0FDQXdDLEVBQUE1RyxLQUlBeUIsU0FBQUMsY0FBMkJsRCxFQUFVSSxPQUFBdUQsaUJBQUEsV0FBQUcsSUFDckMsUUFBQUEsRUFBQXNDLFFBQUEsQ0FDQSxNQUFBNUUsRUFBQXNDLEVBQUFHLE9BQUFoRixNQUNBbUosRUFBQTVHLE1BTUF5QixTQUFBQyxjQUEyQmxELEVBQVVJLE9BQUF1RCxpQkFBQSxhQUNyQ3NFLEVBQUF4QyxVQUFBRSxPQUFBLDBDQUtBMUMsU0FBQUMsY0FBMkJsRCxFQUFVTyxXQUFBb0QsaUJBQUEsYUFDckNvRSxFQUFBMUMsTUFBQThDLFFBQUEsY0FDQUgsRUFBQTNDLE1BQUE4QyxRQUFBLFNBR0EsTUFBQUUsSUFBV0EsRUFBQUMsUUFBQUMsT0FBQUMsUUFBQUMsV0w5Q0osV0FFUCxNQUFBQyxFQUFBLElBQUFDLEtBQ0FOLEVBQUFLLEVBQUFFLFVBSUFOLEVBRkEsZ0hBQ0FJLEVBQUFHLFlBRUFOLEVBQUFHLEVBQUFJLGNBQ0EsSUFBQU4sRUFBQUUsRUFBQUssV0FDQVAsRUFBQW5ILEVBQUFtSCxHQUNBLElBQUFDLEVBQUFDLEVBQUFNLGFBR0EsT0FBWVgsTUFBQUMsUUFBQUMsT0FBQUMsUUFBQUMsUUFGWkEsRUFBQXBILEVBQUFvSCxJS2tDaURRLEdBQ2pEaEcsU0FBQUMsY0FBMkJsRCxFQUFVb0IsTUFBQStDLGVBQXdCa0UsS0FBT0MsTUFBVUMsSUFDOUV0RixTQUFBQyxjQUEyQmxELEVBQVVtQixNQUFBZ0QsZUFBd0JxRSxLQUFTQyxLQUt0RVMiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcbiIsImV4cG9ydCBjb25zdCBET01zdHJpbmdzID0ge1xuICAgIGlucHV0U3VtbWFyeTogJy50YXNrX19kZXNjcmlwdGlvbicsXG4gICAgbmV3SXRlbTogJy5uZXctaXRlbScsXG4gICAgY3JlYXRlTmV3SXRlbTogJy5hZGQtbmV3LWl0ZW0nLFxuICAgIGlucHV0OiAnLmFkZC1uZXctaXRlbV9fZGVzY3JpcHRpb24nLFxuICAgIGVuYWJsZUVkaXQ6ICcudGFza19fbmFtZScsXG4gICAgc3VibWl0QnRuOiAnLmFkZC1uZXctaXRlbV9fYnRuLWFkZC10YXNrJyxcbiAgICBjYW5jZWxCdG46ICcuYWRkLW5ldy1pdGVtX19idG4tY2FuY2VsJyxcbiAgICB0YXNrc0NvbnRhaW5lcjogJy50YXNrcy1jb250YWluZXInLFxuICAgIGRlbGV0ZUJ0bjogJy50YXNrX19idG4tZGVsZXRlJyxcbiAgICBlZGl0QnRuOiAnLnRhc2tfX2J0bi1lZGl0JyxcbiAgICBkb25lQnRuOiAnLnRhc2tfX2J0bi1kb25lJyxcbiAgICBCdG5zQ29udGFpbmVyOiAnLnRhc2tfX2J0bnMnLFxuICAgIGVkaXRCdG5zQ29udGFpbmVyOiAnLnRhc2tfX2J0bnMtLWVkaXQnLFxuICAgIGV4aXRFZGl0QnRuOiAnLnRhc2tfX2J0bi1leGl0LWVkaXQnLFxuICAgIHRhc2tDaGVja2JveDogJy50YXNrX19jaGVja2JveF9zdmcnLFxuICAgIHRhc2tDaGVja2JveENvbnRhaW5lcjogJy50YXNrX19jaGVja2JveCcsXG4gICAgaW5wdXRGb3JUYXNrVXBkYXRlOiAnLnRhc2tfX2VkaXQtaW5wdXQtdGV4dCcsXG4gICAgdGFza05hbWVXcmFwcGVyOiAnLnRhc2tfX25hbWUtd3JhcHBlcicsXG4gICAgdGltZTogJy5oZWFkZXJfX2RhdGEtLXRpbWUnLFxuICAgIGRhdGU6ICcuaGVhZGVyX19kYXRhLS1kYXRlJ1xuXG59IiwiLy9HZW5lcmF0ZSBSYW5kb20gU3RyaW5nIChjcmVhdGluZyBhIHVuaXF1ZSBJRClcbmV4cG9ydCBmdW5jdGlvbiBtYWtlaWQobGVuZ3RoID0gNSkge1xuICAgIGxldCByZXN1bHQgPSAnJ1xuICAgIGNvbnN0IGNoYXJhY3RlcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODknXG4gICAgY29uc3QgY2hhcmFjdGVyc0xlbmd0aCA9IGNoYXJhY3RlcnMubGVuZ3RoXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICByZXN1bHQgKz0gY2hhcmFjdGVycy5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2hhcmFjdGVyc0xlbmd0aCkpXG4gICAgfVxuICAgIHJldHVybiByZXN1bHRcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudFRpbWUoKSB7XG5cbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gICAgY29uc3QgZGF5ID0gbm93LmdldERhdGUoKVxuXG4gICAgY29uc3QgbW9udGhzID0gWydKYW51YXJ5JywgJ0ZlYnJ1YXJ5JywgJ01hcmNoJywgJ0FwcmlsJywgJ01heScsICdKdW5lJywgJ0p1bHknLCAnQXVndXN0JywgJ1NlcHRlbWJlcicsICdPY3RvYmVyJywgJ05vdmVtYmVyJywgJ0RlY2VtYmVyJ11cbiAgICBjb25zdCBjdXJNb250aCA9IG5vdy5nZXRNb250aCgpXG4gICAgY29uc3QgbW9udGggPSBtb250aHNbY3VyTW9udGhdXG4gICAgY29uc3QgeWVhciA9IG5vdy5nZXRGdWxsWWVhcigpXG4gICAgbGV0IGhvdXJzID0gbm93LmdldEhvdXJzKClcbiAgICBob3VycyA9IGZvcm1hdFRpbWUoaG91cnMpXG4gICAgbGV0IG1pbnV0ZXMgPSBub3cuZ2V0TWludXRlcygpXG4gICAgbWludXRlcyA9IGZvcm1hdFRpbWUobWludXRlcylcblxuICAgIHJldHVybiB7IGRheSwgbW9udGgsIHllYXIsIGhvdXJzLCBtaW51dGVzIH1cbn1cblxuZnVuY3Rpb24gZm9ybWF0VGltZSh0aW1lKSB7XG4gICAgcmV0dXJuIHRpbWUgPCAxMCA/IGAwJHt0aW1lfWAgOiB0aW1lXG59XG4iLCJpbXBvcnQgeyBtYWtlaWQgfSBmcm9tICcuL2hlbHBlcnMnXG5cblxuXG4vLyBjbGFzcyBUYXNrIGRlc2NyIGlkIHN1bW1hcnkgcHJpb3JpdHlcblxuY2xhc3MgVGFzayB7XG4gICAgY29uc3RydWN0b3Ioc3VtbWFyeSkge1xuICAgICAgICB0aGlzLnN1bW1hcnkgPSBzdW1tYXJ5O1xuICAgICAgICB0aGlzLmlkID0gbWFrZWlkKDUpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVGFzayIsImltcG9ydCB7IERPTXN0cmluZ3MgfSBmcm9tICcuL2RvbVN0cmluZ3MnXG5pbXBvcnQgVGFza3NDb250cm9sbGVyIGZyb20gJy4vVGFza3NDb250cm9sbGVyJ1xuXG5jb25zdCBkb25lRXhpdEJ0bnMgPSBgPGkgY2xhc3M9XCJ0YXNrX19idG4tZG9uZVwiPjwvaT5cbjxpIGNsYXNzPVwidGFza19fYnRuLWV4aXQtZWRpdFwiPjwvaT5gXG5jb25zdCBlZGl0RGVsZXRlQnRucyA9IGA8aSBjbGFzcz1cInRhc2tfX2J0bi1lZGl0XCI+PC9pPlxuPGkgY2xhc3M9XCJ0YXNrX19idG4tZGVsZXRlXCI+PC9pPmBcbmNvbnN0IHNwYW5IZWlnaHRXaXRoT25lTGluZSA9IDM3XG5jb25zdCBtYXhUZXh0QXJlYUhlaWdodCA9IDEwMFxuXG5cbmNsYXNzIFRhc2tWaWV3IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy51cGRhdGVTdW1tYXJ5ID0gdGhpcy51cGRhdGVTdW1tYXJ5LmJpbmQodGhpcylcbiAgICAgICAgdGhpcy5rZXlQcmVzc0hhbmRsZXIgPSB0aGlzLmtleVByZXNzSGFuZGxlci5iaW5kKHRoaXMpXG4gICAgICAgIHRoaXMuZWRpdEJ0bkNsaWNrSGFuZGxlciA9IHRoaXMuZWRpdEJ0bkNsaWNrSGFuZGxlci5iaW5kKHRoaXMpXG4gICAgICAgIHRoaXMuZG9jdW1lbnRDbGlja0hhbmRsZXIgPSB0aGlzLmRvY3VtZW50Q2xpY2tIYW5kbGVyLmJpbmQodGhpcylcbiAgICAgICAgdGhpcy5jbGlja09uRXhpdEJ0bkhhbmRsZXIgPSB0aGlzLmNsaWNrT25FeGl0QnRuSGFuZGxlci5iaW5kKHRoaXMpXG4gICAgICAgIHRoaXMuY2hlY2tib3hEaXNwbGF5SGFuZGxlciA9IHRoaXMuY2hlY2tib3hEaXNwbGF5SGFuZGxlci5iaW5kKHRoaXMpXG4gICAgfVxuXG4gICAgYWRkVGFza1RvVUkodGFzaykge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKERPTXN0cmluZ3MudGFza3NDb250YWluZXIpXG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmdldFRhc2tIdG1sU3RyaW5nKHRhc2spXG4gICAgICAgIGNvbnRhaW5lci5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIGVsZW1lbnQpXG5cbiAgICAgICAgY29uc3QgY3JlYXRlZEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXNrLmlkKVxuICAgICAgICB0aGlzLmFkZFRhc2tFdmVudExpc3RlbmVycyhjcmVhdGVkRWxlbWVudClcblxuICAgIH1cblxuICAgIHJlbW92ZVRhc2tGcm9tVUkoaWQpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKVxuICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudClcbiAgICB9XG5cbiAgICBhZGRUYXNrRXZlbnRMaXN0ZW5lcnMoZWxlbWVudCkge1xuICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoRE9Nc3RyaW5ncy5lZGl0QnRuKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZWRpdEJ0bkNsaWNrSGFuZGxlcilcbiAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKERPTXN0cmluZ3MuZGVsZXRlQnRuKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIFRhc2tzQ29udHJvbGxlci5kZWxldGVUYXNrKVxuICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoRE9Nc3RyaW5ncy50YXNrQ2hlY2tib3gpLmFkZEV2ZW50TGlzdGVuZXIoJ2FuaW1hdGlvbmVuZCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgVGFza3NDb250cm9sbGVyLmRlbGV0ZVRhc2soZXZlbnQsIHRydWUpXG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgZWRpdEJ0bkNsaWNrSGFuZGxlcihldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuXG4gICAgICAgIGNvbnN0IGVkaXRpbmdFbGVtZW50ID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoXCIudGFza1wiKVxuICAgICAgICBjb25zdCB2YWx1ZSA9IGVkaXRpbmdFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrX19uYW1lJykudGV4dENvbnRlbnRcblxuICAgICAgICBjb25zdCBidG5zQ29udGFpbmVyID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoRE9Nc3RyaW5ncy5CdG5zQ29udGFpbmVyKVxuXG4gICAgICAgIHRoaXMuY2hlY2tib3hEaXNwbGF5SGFuZGxlcihlZGl0aW5nRWxlbWVudCk7XG5cbiAgICAgICAgLy9SZXBsYWNpbmcgYnV0dG9ucyBcbiAgICAgICAgYnRuc0NvbnRhaW5lci5pbm5lckhUTUwgPSBkb25lRXhpdEJ0bnNcblxuICAgICAgICAvL1N1bW1hcnkgY29udGFpbmVyXG4gICAgICAgIGNvbnN0IHRhc2tOYW1lV3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVkaXRpbmdFbGVtZW50LmlkKS5xdWVyeVNlbGVjdG9yKERPTXN0cmluZ3MudGFza05hbWVXcmFwcGVyKVxuICAgICAgICBjb25zdCB0ZXh0U3BhbkhlaWdodCA9IHRhc2tOYW1lV3JhcHBlci5maXJzdEVsZW1lbnRDaGlsZC5vZmZzZXRIZWlnaHQ7XG5cbiAgICAgICAgLy9BZGRpbmcgZXZlbnRsaXN0ZW5lcnMgZG9uZUV4aXRCdG5zXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoRE9Nc3RyaW5ncy5kb25lQnRuKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudXBkYXRlU3VtbWFyeSlcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihET01zdHJpbmdzLmV4aXRFZGl0QnRuKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbGlja09uRXhpdEJ0bkhhbmRsZXIoZXZlbnQsIHZhbHVlLCB0YXNrTmFtZVdyYXBwZXIsIGJ0bnNDb250YWluZXIpXG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgZWRpdElucHV0ID0gYDx0ZXh0YXJlYSBjbGFzcz1cInRhc2tfX2VkaXQtaW5wdXQtdGV4dCBcIiB0eXBlPVwidGV4dFwiIGF1dG9mb2N1cz4ke3ZhbHVlfTwvdGV4dGFyZWE+YFxuICAgICAgICB0YXNrTmFtZVdyYXBwZXIuaW5uZXJIVE1MID0gZWRpdElucHV0XG5cblxuICAgICAgICBjb25zdCB0ZXh0QXJlYSA9IHRhc2tOYW1lV3JhcHBlci5maXJzdENoaWxkXG4gICAgICAgIHRleHRBcmVhLnNlbGVjdCgpXG5cbiAgICAgICAgdGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmlucHV0SGFuZGxlcilcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmRvY3VtZW50Q2xpY2tIYW5kbGVyKVxuICAgICAgICB0ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIHRoaXMua2V5UHJlc3NIYW5kbGVyKVxuXG4gICAgICAgIC8vL01ha2luZyB0ZXh0YXJlYSBpbml0aWFsIHNpemVcbiAgICAgICAgbGV0IG5leHRIZWlnaHQgPSBNYXRoLm1pbihtYXhUZXh0QXJlYUhlaWdodCwgdGV4dFNwYW5IZWlnaHQpXG4gICAgICAgIGNvbnN0IHRleHRBcmVhUGFkZGluZ1RvcCA9IHBhcnNlRmxvYXQod2luZG93LmdldENvbXB1dGVkU3R5bGUodGV4dEFyZWEsIG51bGwpLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctdG9wJykpXG4gICAgICAgIHRleHRBcmVhLnN0eWxlLmhlaWdodCA9IG5leHRIZWlnaHQgKyAoMiAqIHRleHRBcmVhUGFkZGluZ1RvcCkgKyAncHgnXG4gICAgfVxuXG4gICAgY2hlY2tib3hEaXNwbGF5SGFuZGxlcihlZGl0aW5nVGFzaykge1xuICAgICAgICBjb25zdCBjaGVja2JveCA9IGVkaXRpbmdUYXNrLnF1ZXJ5U2VsZWN0b3IoRE9Nc3RyaW5ncy50YXNrQ2hlY2tib3hDb250YWluZXIpXG4gICAgICAgIGlmIChjaGVja2JveC5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2tfX2NoZWNrYm94LS1oaWRkZW4nKSkge1xuICAgICAgICAgICAgY2hlY2tib3guY2xhc3NMaXN0LnJlbW92ZSgndGFza19fY2hlY2tib3gtLWhpZGRlbicpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGVja2JveC5jbGFzc0xpc3QuYWRkKCd0YXNrX19jaGVja2JveC0taGlkZGVuJylcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNsaWNrT25FeGl0QnRuSGFuZGxlcihldmVudCwgdmFsdWUsIHRhc2tOYW1lV3JhcHBlciwgYnRuc0NvbnRhaW5lcikge1xuICAgICAgICBjb25zdCBhZnRlckV4aXRTcGFuID0gYCA8c3BhbiBjbGFzcz1cInRhc2tfX25hbWVcIj4ke3ZhbHVlfTwvc3Bhbj5gXG4gICAgICAgIGNvbnN0IHRhc2tFbGVtZW50ID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy50YXNrJylcblxuICAgICAgICB0YXNrTmFtZVdyYXBwZXIuaW5uZXJIVE1MID0gYWZ0ZXJFeGl0U3BhblxuICAgICAgICBidG5zQ29udGFpbmVyLmlubmVySFRNTCA9IGVkaXREZWxldGVCdG5zXG5cbiAgICAgICAgdGhpcy5jaGVja2JveERpc3BsYXlIYW5kbGVyKHRhc2tFbGVtZW50KVxuXG4gICAgICAgIHRoaXMuYWRkVGFza0V2ZW50TGlzdGVuZXJzKHRhc2tFbGVtZW50KVxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZG9jdW1lbnRDbGlja0hhbmRsZXIpXG5cblxuICAgIH1cblxuICAgIGRvY3VtZW50Q2xpY2tIYW5kbGVyKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGlnbm9yaW5nRWxlbWVudHMgPSBbJ3Rhc2tfX2VkaXQtaW5wdXQtdGV4dCcsICd0YXNrX19idG4tZG9uZScsICd0YXNrX19idG4tZXhpdC1lZGl0J11cbiAgICAgICAgY29uc3QgY2xhc3NOYW1lID0gZXZlbnQudGFyZ2V0LmNsYXNzTGlzdFswXVxuXG4gICAgICAgIGlmICghaWdub3JpbmdFbGVtZW50cy5pbmNsdWRlcyhjbGFzc05hbWUpKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN1bW1hcnkoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5wdXRIYW5kbGVyKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlXG4gICAgICAgIGV2ZW50LnRhcmdldC5yb3dzID0gMVxuICAgICAgICBldmVudC50YXJnZXQuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHtcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5oZWlnaHQgPSBzcGFuSGVpZ2h0V2l0aE9uZUxpbmUgKyAncHgnXG4gICAgICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmFkZCgndGFza19fZWRpdC1pbnB1dC10ZXh0LS1pbnZhbGlkJylcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsSGVpZ2h0ID0gZXZlbnQudGFyZ2V0LnNjcm9sbEhlaWdodDtcbiAgICAgICAgICAgIGxldCBuZXh0SGVpZ2h0ID0gTWF0aC5taW4obWF4VGV4dEFyZWFIZWlnaHQsIHNjcm9sbEhlaWdodClcblxuICAgICAgICAgICAgZXZlbnQudGFyZ2V0LnN0eWxlLmhlaWdodCA9IG5leHRIZWlnaHQgKyAncHgnXG4gICAgICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgndGFza19fZWRpdC1pbnB1dC10ZXh0LS1pbnZhbGlkJylcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGtleVByZXNzSGFuZGxlcihldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlICE9PSAnJykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3VtbWFyeShldmVudClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHVwZGF0ZVN1bW1hcnkoKSB7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihET01zdHJpbmdzLmlucHV0Rm9yVGFza1VwZGF0ZSlcbiAgICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZVxuICAgICAgICBjb25zdCB0YXNrRWxlbWVudCA9IGlucHV0LmNsb3Nlc3QoXCIudGFza1wiKVxuICAgICAgICBjb25zdCBpZCA9IHRhc2tFbGVtZW50LmlkXG5cbiAgICAgICAgY29uc3QgYnRuc0NvbnRhaW5lciA9IHRhc2tFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoRE9Nc3RyaW5ncy5CdG5zQ29udGFpbmVyKVxuICAgICAgICBjb25zdCB0YXNrTmFtZVdyYXBwZXIgPSB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKERPTXN0cmluZ3MudGFza05hbWVXcmFwcGVyKVxuXG4gICAgICAgIHRoaXMuY2hlY2tib3hEaXNwbGF5SGFuZGxlcih0YXNrRWxlbWVudClcblxuICAgICAgICBpZiAodmFsdWUgIT09ICcnKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZG9jdW1lbnRDbGlja0hhbmRsZXIpXG4gICAgICAgICAgICBjb25zdCBhZnRlckVkaXRTcGFuID0gYCA8c3BhbiBjbGFzcz1cInRhc2tfX25hbWVcIj4ke3ZhbHVlfTwvc3Bhbj5gXG4gICAgICAgICAgICBidG5zQ29udGFpbmVyLmlubmVySFRNTCA9IGVkaXREZWxldGVCdG5zXG4gICAgICAgICAgICB0YXNrTmFtZVdyYXBwZXIuaW5uZXJIVE1MID0gYWZ0ZXJFZGl0U3BhblxuICAgICAgICAgICAgdGhpcy5hZGRUYXNrRXZlbnRMaXN0ZW5lcnModGFza0VsZW1lbnQpXG4gICAgICAgICAgICBUYXNrc0NvbnRyb2xsZXIudXBkYXRlVGFzayhpZCwgdmFsdWUpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRUYXNrSHRtbFN0cmluZyh0YXNrKSB7XG4gICAgICAgIHJldHVybiAoYDxkaXYgY2xhc3M9XCJ0YXNrXCIgaWQ9XCIke3Rhc2suaWR9XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0YXNrX19jb250ZW50LXdyYXBwZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInRhc2tfX2Rlc2NyaXB0aW9uXCI+XG4gICAgICAgIDxsYWJlbCBjbGFzcz0ndGFza19fY2hlY2tib3gnPlxuICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmFtZT1cImNoZWNrXCI+XG4gICAgICAgIDxzdmcgdmVyc2lvbj1cIjEuMVwiIGNsYXNzPVwidGFza19fY2hlY2tib3hfc3ZnXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiXG4gICAgICAgICAgICB4bWxuczp4bGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiB4PVwiMHB4XCIgeT1cIjBweFwiIHZpZXdCb3g9XCIwIDAgMTAwIDEwMFwiXG4gICAgICAgICAgICBzdHlsZT1cImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTAwIDEwMDtcIiB4bWw6c3BhY2U9XCJwcmVzZXJ2ZVwiPlxuICAgICAgICAgICAgPHBvbHlsaW5lIGNsYXNzPVwidGFza19fY2hlY2tib3hfbGluZVwiIHBvaW50cz1cIjMuNSw0NS41IDQwLjUsODIuNSA5NS43LDE1LjMgXCJcbiAgICAgICAgICAgICAgICBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgLz48L3N2Zz5cbiAgICA8L2xhYmVsPlxuICAgIFxuICAgIDxkaXYgY2xhc3M9XCJ0YXNrX19uYW1lLXdyYXBwZXJcIj5cbiAgICA8c3BhbiBjbGFzcz1cInRhc2tfX25hbWVcIiB0aXRsZT1cIiR7dGFzay5zdW1tYXJ5fVwiPiR7dGFzay5zdW1tYXJ5fTwvc3Bhbj5cbiAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwidGFza19fYnRuc1wiPlxuICAgIDxpIGNsYXNzPVwidGFza19fYnRuLWVkaXRcIj48L2k+XG4gICAgPGkgY2xhc3M9XCJ0YXNrX19idG4tZGVsZXRlXCI+PC9pPlxuICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJsaW5lXCI+PC9kaXY+PC9kaXY+YClcbiAgICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgVGFza1ZpZXc7IiwiaW1wb3J0IHsgRE9Nc3RyaW5ncyB9IGZyb20gJy4vZG9tU3RyaW5ncydcbmltcG9ydCBUYXNrTW9kZWwgZnJvbSAnLi9UYXNrTW9kZWwnXG5pbXBvcnQgVGFza1ZpZXcgZnJvbSAnLi9UYXNrVmlldydcblxuXG5jb25zdCB0YXNrTW9kZWwgPSBuZXcgVGFza01vZGVsKClcbmNvbnN0IHRhc2tWaWV3ID0gbmV3IFRhc2tWaWV3KClcbi8vIENSVUQgLy8gQ3JlYXRlIFJlYWQgVXBkYXRlIERlbGV0ZVxuXG5jbGFzcyBUYXNrc0NvbnRyb2xsZXIge1xuICAgIGNyZWF0ZVRhc2soc3VtbWFyeSkge1xuICAgICAgICBjb25zdCBuZXdUYXNrID0gdGFza01vZGVsLmNyZWF0ZVRhc2soc3VtbWFyeSlcbiAgICAgICAgLy9BZGQgbmV3IHRhc2sgdG8gVUlcblxuICAgICAgICB0YXNrVmlldy5hZGRUYXNrVG9VSSh7IC4uLm5ld1Rhc2sgfSlcbiAgICB9XG5cbiAgICByZW5kZXJUYXNrcygpIHtcbiAgICAgICAgY29uc3QgdGFza3MgPSB0YXNrTW9kZWwucmVhZFRhc2tzKCk7XG4gICAgICAgIHRhc2tzLmZvckVhY2goY3VyID0+IHRhc2tWaWV3LmFkZFRhc2tUb1VJKGN1cikpXG4gICAgfVxuXG4gICAgZGVsZXRlVGFzayhldmVudCkge1xuICAgICAgICBjb25zdCBpdGVtSUQgPSBldmVudC50YXJnZXQuY2xvc2VzdChcIi50YXNrXCIpLmlkXG4gICAgICAgIHRhc2tNb2RlbC5kZWxldGVUYXNrKGl0ZW1JRClcblxuICAgICAgICAvL1JlbW92ZSB0YXNrIGZyb20gVUkgXG4gICAgICAgIHRhc2tWaWV3LnJlbW92ZVRhc2tGcm9tVUkoaXRlbUlEKVxuICAgICAgICB0YXNrTW9kZWwuc2F2ZUNoYW5nZXNUb0xvY2FsU3RvcmFnZSgpXG5cbiAgICB9XG5cbiAgICAvL0VkaXQgVGFza1xuICAgIHVwZGF0ZVRhc2soaWQsIHZhbHVlKSB7XG4gICAgICAgIHRhc2tNb2RlbC51cGRhdGVUYXNrKGlkLCB2YWx1ZSlcbiAgICB9O1xuXG59XG5cblxuY29uc3QgdGFza3NDb250cm9sbGVyID0gbmV3IFRhc2tzQ29udHJvbGxlcigpXG5cbmV4cG9ydCBkZWZhdWx0IHRhc2tzQ29udHJvbGxlciIsImltcG9ydCBUYXNrIGZyb20gJy4vVGFzaydcblxuY2xhc3MgVGFza01vZGVsIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy50YXNrcyA9IFtdXG5cbiAgICB9XG5cbiAgICBjcmVhdGVUYXNrKHN1bW1hcnkpIHtcbiAgICAgICAgLy9DcmVhdGUgTmV3IFRhc2tcbiAgICAgICAgY29uc3QgbmV3VGFzayA9IG5ldyBUYXNrKHN1bW1hcnkpXG5cbiAgICAgICAgLy9QdXNoIG5ldyB0YXNrIGludG8gZGF0YSBzdHJ1Y3R1cmUgKHRoaXMudGFza3MgYXJyYXkpXG4gICAgICAgIHRoaXMudGFza3MucHVzaChuZXdUYXNrKVxuICAgICAgICB0aGlzLnNhdmVDaGFuZ2VzVG9Mb2NhbFN0b3JhZ2UoKVxuICAgICAgICByZXR1cm4gbmV3VGFza1xuXG4gICAgfVxuXG4gICAgcmVhZFRhc2tzKCkge1xuICAgICAgICB0aGlzLnRhc2tzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndGFza3MnKSkgfHwgW11cbiAgICAgICAgcmV0dXJuIHRoaXMudGFza3NcbiAgICB9XG5cbiAgICAvL0RlbGV0ZSB0YXNrXG4gICAgZGVsZXRlVGFzayhpZCkge1xuICAgICAgICAvL0RlbGV0ZSB0YXNrIGZyb20gZGF0YSBzdHJ1Y3R1cmVcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnRhc2tzLmZpbmRJbmRleChjdXIgPT4gY3VyLmlkID09PSBpZClcblxuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLnRhc2tzLnNwbGljZShpbmRleCwgMSlcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2F2ZUNoYW5nZXNUb0xvY2FsU3RvcmFnZSgpXG4gICAgfVxuXG4gICAgLy9FZGl0IFRhc2tcbiAgICB1cGRhdGVUYXNrKGlkLCB2YWx1ZSkge1xuICAgICAgICBjb25zdCBjdXJyZW50VGFzayA9IHRoaXMudGFza3MuZmluZChjdXIgPT4gY3VyLmlkID09PSBpZClcbiAgICAgICAgY3VycmVudFRhc2suc3VtbWFyeSA9IHZhbHVlXG4gICAgICAgIHRoaXMuc2F2ZUNoYW5nZXNUb0xvY2FsU3RvcmFnZSgpXG4gICAgfVxuXG5cbiAgICBzYXZlQ2hhbmdlc1RvTG9jYWxTdG9yYWdlKCkge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGFza3MnLCBKU09OLnN0cmluZ2lmeSh0aGlzLnRhc2tzKSlcbiAgICB9XG5cbn1cblxuXG5leHBvcnQgZGVmYXVsdCBUYXNrTW9kZWw7IiwiaW1wb3J0ICcuL21haW4uc2Nzcyc7XG5pbXBvcnQgVGFza3NDb250cm9sbGVyIGZyb20gJy4vanMvVGFza3NDb250cm9sbGVyJ1xuaW1wb3J0IHsgRE9Nc3RyaW5ncyB9IGZyb20gJy4vanMvZG9tU3RyaW5ncydcbmltcG9ydCB7IGdldEN1cnJlbnRUaW1lIH0gZnJvbSAnLi9qcy9oZWxwZXJzJ1xuXG5cbmNvbnN0IGluaXQgPSAoKSA9PiB7XG4gICAgY29uc3QgbmV3SXRlbVN0eWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihET01zdHJpbmdzLm5ld0l0ZW0pXG4gICAgY29uc3QgY3JlYXRlTmV3SXRlbVN0eWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihET01zdHJpbmdzLmNyZWF0ZU5ld0l0ZW0pXG4gICAgY29uc3QgdG9nZ2xlU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihET01zdHJpbmdzLnN1Ym1pdEJ0bilcblxuXG4gICAgLy9cbiAgICBUYXNrc0NvbnRyb2xsZXIucmVuZGVyVGFza3MoKVxuXG4gICAgLy9DbGljayBvbiBhZGQgbmV3IGl0ZW1cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKERPTXN0cmluZ3MubmV3SXRlbSkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIG5ld0l0ZW1TdHlsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG4gICAgICAgIGNyZWF0ZU5ld0l0ZW1TdHlsZS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jaydcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihET01zdHJpbmdzLmlucHV0KS52YWx1ZSA9ICcnXG4gICAgfSk7XG5cbiAgICAvL0NsaWNrIG9uIHN1Ym1pdCBidG5cbiAgICBjb25zdCBhZGRUYXNrID0gKHN1bW1hcnkpID0+IHtcbiAgICAgICAgaWYgKHN1bW1hcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICBUYXNrc0NvbnRyb2xsZXIuY3JlYXRlVGFzayhzdW1tYXJ5KVxuICAgICAgICAgICAgbmV3SXRlbVN0eWxlLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWZsZXgnXG4gICAgICAgICAgICBjcmVhdGVOZXdJdGVtU3R5bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihET01zdHJpbmdzLnN1Ym1pdEJ0bikuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1bW1hcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKERPTXN0cmluZ3MuaW5wdXQpLnZhbHVlO1xuICAgICAgICB0b2dnbGVTdWJtaXRCdG4uY2xhc3NMaXN0LmFkZCgnYWRkLW5ldy1pdGVtX19idG4tYWRkLXRhc2stLWRpc2FibGVkJylcbiAgICAgICAgYWRkVGFzayhzdW1tYXJ5KVxuICAgIH0pO1xuXG4gICAgLy9QcmVzcyBvbiBlbnRlclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoRE9Nc3RyaW5ncy5pbnB1dCkuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgICAgICAgICBjb25zdCBzdW1tYXJ5ID0gZXZlbnQudGFyZ2V0LnZhbHVlXG4gICAgICAgICAgICBhZGRUYXNrKHN1bW1hcnkpXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vSW5wdXQgY2hhbmdlXG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKERPTXN0cmluZ3MuaW5wdXQpLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICB0b2dnbGVTdWJtaXRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnYWRkLW5ldy1pdGVtX19idG4tYWRkLXRhc2stLWRpc2FibGVkJylcbiAgICB9KTtcblxuXG4gICAgLy9DbGljayBvbiBjYW5jZWwgYnRuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihET01zdHJpbmdzLmNhbmNlbEJ0bikuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIG5ld0l0ZW1TdHlsZS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1mbGV4J1xuICAgICAgICBjcmVhdGVOZXdJdGVtU3R5bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xuICAgIH0pO1xuXG4gICAgY29uc3QgeyBkYXksIG1vbnRoLCB5ZWFyLCBob3VycywgbWludXRlcyB9ID0gZ2V0Q3VycmVudFRpbWUoKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKERPTXN0cmluZ3MuZGF0ZSkudGV4dENvbnRlbnQgPSBgJHtkYXl9ICR7bW9udGh9LCAke3llYXJ9YFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoRE9Nc3RyaW5ncy50aW1lKS50ZXh0Q29udGVudCA9IGAke2hvdXJzfToke21pbnV0ZXN9YFxuXG59O1xuXG5cbmluaXQoKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=